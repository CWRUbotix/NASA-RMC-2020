<?xml version="1.0"?>
<launch>
    <!-- "true" if running roscore from the robot -->
    <arg name="on_robot" value="$(eval '192.168.0.100' in optenv('ROS_MASTER_URI'))"/>

    <rosparam command="load" file = "$(find glenn_launcher)/params/obstacle_detection/obstacle_detection_params.yaml" ns="obstacle_detection"/>

    <!-- only run if not using simulator -->
    <node name="realsense_imu_filter" pkg="imu_filter_madgwick" type="imu_filter_node">
        <remap from="/imu/data_raw" to="/imu_realsense/data_raw"/>
        <remap from="/imu/data" to="/imu_realsense/data"/>
        <param name="use_mag" value="false"/>
        <param name="publish_tf" value="true"/>
        <param name="fixed_frame" value="realsense_footprint_link"/>
        <param name="remove_yaw_tf" value="true"/>
        <param name="reverse_tf" value="false"/>
    </node>

    <node name="calibrator" pkg="imu_calibrator" type="imu_calibrator" ns="imu_realsense">
        <param name="calibrate_time" value="2.0"/>
        <param name="still_range" value="0.2"/>
        <param name="default_bias_x" value="0.0"/>
        <param name="default_bias_y" value="0.0"/>
        <param name="default_bias_z" value="0.0"/>
    </node>

    <node name="calibrator" pkg="imu_calibrator" type="imu_calibrator" ns="imu">
        <param name="calibrate_time" value="2.0"/>
        <param name="still_range" value="0.2"/>
        <param name="default_bias_x" value="0.0"/>
        <param name="default_bias_y" value="0.0"/>
        <param name="default_bias_z" value="0.0"/>
    </node>

    <node name="obstacle_detection_node" pkg="obstacle_detection" type="obstacle_detection_node.py" output="screen" cwd="node"/>
    <node name="global_occupancy_grid_node" pkg="obstacle_detection" type="global_occupancy_grid_node.py" output="screen" cwd="node"/>
</launch>
